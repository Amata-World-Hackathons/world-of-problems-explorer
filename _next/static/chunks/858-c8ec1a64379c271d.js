"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[858],{6858:function(e,t,r){r.r(t),r.d(t,{default:function(){return O}});var n=r(5893),a=r(9008),o=r(1163),l=r(6158),c=r.n(l),i=r(4184),s=r.n(i),u=r(9612),d=r(7294),f=r(7640);function h(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}c().accessToken="pk.eyJ1IjoiYW1hdGFoYWNrc25qYW1zIiwiYSI6ImNsMHAzNWdkdDFnOHQzZHBlMmx0Mml6a3IifQ.aKW4wLfYZuEPgoisxwRjdw";var m="countries-layer",p="anchors-layer",y="countries",x="anchors",j=d.createContext({view:{zoom:1,loading:!0},projectAnchorsResult:{loading:!0},setProjectAnchorsQuery:function(){}});var g=function(e){var t=e.children,r=e.className,a=e.onClickAnchor,i=(0,u.NB)(),g=i.width,v=i.height,b=i.ref,w=(0,d.useRef)(null),k=(0,d.useRef)(a),N=((0,d.useRef)(null),(0,d.useState)([-.1440787,51.501364])),I=N[0],E=N[1],S=(0,d.useState)(1),O=S[0],C=S[1],P=(0,d.useState)({}),A=P[0],R=P[1],z=(0,d.useState)(!0),q=z[0],L=z[1],D=(0,o.useRouter)(),F=(0,f.Jh)(A);(0,d.useEffect)((function(){if(b.current&&!w.current){var e=new l.Map({container:b.current,style:"mapbox://styles/amatahacksnjams/cl0rayyhv00c214n2ngjn40ri",center:I,zoom:O,minZoom:0});e.on("move",(function(){var t=e.getCenter().lat,r=e.getCenter().lng;E([r,t]),C(e.getZoom())})),w.current=e,e.on("load",(function(){var t=function(e){return!e.originalEvent.cancelBubble&&(e.originalEvent.cancelBubble=!0,e.originalEvent.preventDefault(),!0)};e.addSource(y,{type:"geojson",data:"https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson"}),e.addLayer({id:m,type:"fill",source:y,paint:{"fill-color":"rgba(100, 200, 240, 0.4)","fill-color-transition":{delay:1e3,duration:3e3},"fill-outline-color":"rgba(100, 200, 240, 1)"}});var r="iconimg",n=200;e.addImage(r,{width:n,height:n,data:new Uint8ClampedArray(16e4),onAdd:function(){var e=document.createElement("canvas");e.width=n,e.height=n,this.context=e.getContext("2d")},render:function(){var t=performance.now()%1e3/1e3,r=70*t+30,n=this.context;return n.clearRect(0,0,this.width,this.height),n.beginPath(),n.arc(this.width/2,this.height/2,r,0,2*Math.PI),n.fillStyle="rgba(255, 200, 200, ".concat(1-t,")"),n.fill(),n.beginPath(),n.arc(this.width/2,this.height/2,30,0,2*Math.PI),n.fillStyle="rgba(255, 100, 100, 1)",n.strokeStyle="white",n.lineWidth=2+4*(1-t),n.fill(),n.stroke(),this.data=n.getImageData(0,0,this.width,this.height).data,e.triggerRepaint(),!0}},{pixelRatio:2}),e.addSource(x,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),e.addLayer({id:p,type:"symbol",source:x,layout:{"icon-image":r}}),e.on("click",p,(function(e){t(e)&&k.current&&k.current(e.features[0].properties)})),e.on("click",m,(function(r){t(r)&&function(e,t){var r=t.geometry,n=null;switch(r.type){case"MultiPolygon":var a=r.coordinates,o=a[0][0];n=new(c().LngLatBounds)(o[0],o[0]);var l=!0,i=!1,s=void 0;try{for(var u,d=a[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value,h=!0,m=!1,p=void 0;try{for(var y,x=f[Symbol.iterator]();!(h=(y=x.next()).done);h=!0){var j=y.value,g=!0,v=!1,b=void 0;try{for(var w,k=j[Symbol.iterator]();!(g=(w=k.next()).done);g=!0){var N=w.value;n.extend(N)}}catch(_){v=!0,b=_}finally{try{g||null==k.return||k.return()}finally{if(v)throw b}}}}catch(_){m=!0,p=_}finally{try{h||null==x.return||x.return()}finally{if(m)throw p}}}}catch(_){i=!0,s=_}finally{try{l||null==d.return||d.return()}finally{if(i)throw s}}break;case"Polygon":var I=r.coordinates,E=I[0];n=new(c().LngLatBounds)(E[0],E[0]);var S=!0,O=!1,C=void 0;try{for(var P,A=I[Symbol.iterator]();!(S=(P=A.next()).done);S=!0){var R=P.value,z=!0,q=!1,L=void 0;try{for(var D,F=R[Symbol.iterator]();!(z=(D=F.next()).done);z=!0){var U=D.value;n.extend(U)}}catch(_){q=!0,L=_}finally{try{z||null==F.return||F.return()}finally{if(q)throw L}}}}catch(_){O=!0,C=_}finally{try{S||null==A.return||A.return()}finally{if(O)throw C}}break;default:var B=r.coordinates;n=new(c().LngLatBounds)(B[0],B[0]);var M=!0,W=!1,T=void 0;try{for(var Z,Q=B[Symbol.iterator]();!(M=(Z=Q.next()).done);M=!0){var Y=Z.value;n.extend(Y)}}catch(_){W=!0,T=_}finally{try{M||null==Q.return||Q.return()}finally{if(W)throw T}}}e.fitBounds(n,{padding:5})}(e,r.features[0])})),e.on("mouseenter",m,(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave",m,(function(){e.getCanvas().style.cursor=""})),e.on("mouseenter",p,(function(t){e.getCanvas().style.cursor="pointer"})),L(!1)}))}}),[b.current]),(0,d.useEffect)((function(){if(D.query.lat&&D.query.lng&&D.query.zoom){var e,t,r=D.query,n=r.lat,a=r.lng,o=r.zoom,l=h(r,["lat","lng","zoom"]);null===(e=w.current)||void 0===e||e.setCenter([parseFloat(a),parseFloat(n)]),null===(t=w.current)||void 0===t||t.setZoom(parseFloat(o)),D.replace({pathname:"/",query:l},void 0,{shallow:!0})}}),[D]),(0,d.useEffect)((function(){w.current&&w.current.resize()}),[g,v,w]),(0,d.useEffect)((function(){if(w.current){var e=F.data;if(e){var t=w.current.getSource(x);t&&t.setData(e)}}}),[w,F.data]);var U=(0,d.useMemo)((function(){return{view:{zoom:O,loading:q},projectAnchorsResult:F,setProjectAnchorsQuery:R}}),[q,O,F]);return(0,n.jsx)("div",{ref:b,className:s()(r,"relative"),children:(0,n.jsx)(j.Provider,{value:U,children:t})})};var v=function(){var e=(0,d.useContext)(j).view;if(e.loading||e.zoom>2.3)return null;var t=Math.min(1,(2.3-e.zoom)/.7);return(0,n.jsxs)("div",{className:"absolute top-0 left-0 bottom-0 right-0 bg-slate-800 pointer-events-none z-10 flex flex-col justify-center items-center",style:{opacity:t},children:[(0,n.jsx)("h3",{className:"text-slate-300 text-xl",children:"World of Problems"}),(0,n.jsx)("div",{className:"text-slate-300 text-3xl",children:"Zoom in to begin"})]})},b=r(8909),w=r(9655),k=r(4297),N=r(1664);function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var S=function(e){var t=e.className,r=e.anchorId,a=e.projectId,l=e.onClose,c=E(e,["className","anchorId","projectId","onClose"]),i=(0,f.n5)(a,r),u=i.data,h=i.loading,m=(0,d.useRef)(l),p=(0,d.useRef)(a),y=(0,o.useRouter)();(0,d.useEffect)((function(){var e=function(e){if(p.current&&"Escape"===e.key)return console.log("CLOSE HERE"),m.current(),e.preventDefault(),!1};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[]),(0,d.useEffect)((function(){m.current=l}),[l]),(0,d.useEffect)((function(){p.current=a}),[a]);var x=null===u||void 0===u?void 0:u.project.tags[0],j=(0,b.JC)(x),g=(0,b.Ep)(x);return(0,n.jsx)("section",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){I(e,t,r[t])}))}return e}({className:s()("bg-slate-800 flex flex-col items-center p-4 transition-opacity duration-500 overflow-y-auto text-slate-300",t,{"opacity-0 pointer-events-none":!a,"opacity-100":a,"justify-center":h})},c,{children:h?(0,n.jsx)(k.Z,{}):u?(0,n.jsxs)("div",{className:"flex flex-col w-full max-w-3xl",children:[(0,n.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[u.project.forkedFromProjectId?(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{children:"this is a fork, "}),(0,n.jsx)(N.default,{href:{pathname:"/projects/[projectId]",query:{projectId:u.project.forkedFromProjectId}},children:(0,n.jsx)("a",{className:s()("underline underline-offset-2",j),children:"check out the original"})})]}):(0,n.jsx)("span",{children:"root project"}),(0,n.jsx)("button",{className:"text-xs",onClick:l,children:"ESC"})]}),(0,n.jsx)("div",{className:s()("w-full h-1 my-4",g)}),(0,n.jsx)("div",{className:"flex-none w-full h-96 bg-no-repeat bg-origin-border bg-center bg-cover my-4",style:{backgroundImage:"url(".concat(u.project.imageUrls[0],")")}}),(0,n.jsx)("div",{className:s()("w-full h-1 mb-4",g)}),(0,n.jsx)("h1",{className:s()("text-3xl mb-6 text-white"),children:u.project.name}),(0,n.jsx)("ul",{className:"flex flex-row flex-wrap",children:u.project.tags.map((function(e){return(0,n.jsx)("li",{className:s()("mr-4 mb-2 underline underline-offset-2",j),children:e},e)}))}),(0,n.jsx)("span",{className:"uppercase text-sm text-white",children:u.project.status}),(0,n.jsxs)("span",{className:"mt-2 text-sm",children:["Proposed: ",u.project.createdDate.toLocaleDateString()]}),(0,n.jsxs)("span",{className:"mt-2 text-sm",children:["Last updated: ",u.project.createdDate.toLocaleDateString()]}),u.project.callToActionUrl?(0,n.jsx)("a",{className:"mt-2 text-xs",target:"_blank",rel:"noreferrer nofollow",href:u.project.callToActionUrl,children:u.project.callToActionUrl}):null,(0,n.jsx)(N.default,{href:{pathname:"/projects/[projectId]/edit",query:{projectId:u.project.id}},children:(0,n.jsx)("a",{className:"mt-2 uppercase text-xs",children:"Edit"})}),(0,n.jsx)("div",{className:s()("w-full h-1 my-4",g)}),(0,n.jsx)("section",{className:"contents-markdown",children:(0,n.jsx)(w.D,{children:u.project.contents})}),(0,n.jsx)("div",{className:s()("w-full h-1 my-4",g)}),(0,n.jsx)("h2",{className:"uppercase text-2xl mb-6",children:"Where"}),(0,n.jsx)("span",{className:"text-slate-400",children:"Impact markers improves the project's visibility and help ground it to reality by showing where the project could make an difference."}),(0,n.jsx)(N.default,{href:{pathname:"/projects/[projectId]/anchors/new",query:{projectId:u.project.id}},children:(0,n.jsx)("a",{className:"mt-4 mb-2 text-sm",children:"Add a new marker"})}),u.anchors.map((function(e){return(0,n.jsxs)("div",{children:[e.imageUrl?(0,n.jsx)("img",{src:e.imageUrl,alt:e.name,className:"m-auto max-w-full mb-4"}):null,(0,n.jsx)("h3",{className:"text-xl mb-2",children:e.name}),(0,n.jsxs)("span",{children:["affects a"," ",(0,n.jsx)("code",{className:"uppercase text-sm",children:e.impactRange})," ","around"," "]}),(0,n.jsx)("button",{className:"underline underline-offset-2",onClick:function(){y.push({pathname:"/",query:(0,b.pQ)(e)},void 0,{shallow:!0})},children:(0,n.jsxs)("code",{children:[e.latitude.toFixed(6),", ",e.longitude.toFixed(6)]})}),e.callToActionUrl?(0,n.jsx)("a",{className:"mt-2 text-xs",target:"_blank",rel:"noreferrer nofollow",href:e.callToActionUrl,children:e.callToActionUrl}):null,(0,n.jsx)("section",{children:(0,n.jsx)(w.D,{children:e.contents})}),(0,n.jsx)("div",{className:s()("w-full h-0.5 my-4",g)})]},e.id)})),u.anchors.length?null:(0,n.jsx)("div",{className:s()("w-full h-0.5 my-4",g)}),(0,n.jsxs)("div",{className:"",children:["Have a better idea? You can create a"," ",(0,n.jsx)(N.default,{href:{pathname:"/projects/[projectId]/fork",query:{projectId:u.project.id}},children:(0,n.jsx)("a",{children:"fork"})})," ","of the project with your own proposal"]}),(0,n.jsx)("hr",{className:"my-4"}),(0,n.jsx)(N.default,{href:"/",children:(0,n.jsx)("a",{children:"Back to the map"})})]}):null}))},O=function(){var e=(0,o.useRouter)(),t=e.query.anchorId?parseInt(e.query.anchorId,10):void 0,r=e.query.projectId||"";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.default,{children:[(0,n.jsx)("title",{children:"Explore a World of Problems"}),(0,n.jsx)("meta",{name:"description",content:"Explore a world of problems"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)(g,{onClickAnchor:function(t){return e.push({pathname:"/projects/[projectId]",query:{projectId:t.projectId}})},className:"w-full h-full m-0 ",children:(0,n.jsx)(v,{})}),(0,n.jsx)(S,{anchorId:t,projectId:r,className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-screen z-20",onClose:function(){return e.push("/")}})]})}},8909:function(e,t,r){r.d(t,{iF:function(){return n},Ep:function(){return o},JC:function(){return l},pQ:function(){return c}});var n=["technology","artificial intelligence","augmented reality","health","medicine","well-being","spirituality","exercise","environment","pollution","water-pollution","air-pollution","deforestation","endangered-species","society","culture","history","poverty","obesity","humanitarian","charity","disaster-relief","humanitarian-aid"];function a(e){switch(e){case"technology":case"artificial intelligence":case"augmented reality":return"technology";case"health":case"medicine":case"well-being":case"spirituality":case"exercise":return"health";case"environment":case"pollution":case"water-pollution":case"air-pollution":case"deforestation":case"endangered-species":return"environment";case"society":case"culture":case"history":case"poverty":case"obesity":return"society";case"charity":case"humanitarian":case"disaster-relief":case"humanitarian-aid":return"humanitarian"}}function o(e){switch(a(e)){case"environment":return"bg-green-500";case"health":return"bg-pink-500";case"humanitarian":return"bg-red-500";case"society":return"bg-teal-500";case"technology":return"bg-sky-500";default:return"bg-slate-500"}}function l(e){switch(a(e)){case"environment":return"text-green-500";case"health":return"text-pink-500";case"humanitarian":return"text-red-500";case"society":return"text-teal-500";case"technology":return"text-sky-500";default:return"text-slate-500"}}function c(e){var t=2.1;switch(e.impactRange){case"location":t=15;break;case"neighbourhood":t=12;break;case"state":t=9.8;break;case"country":t=7;break;case"continent":t=4}return{lat:e.latitude,lng:e.longitude,zoom:t}}}}]);