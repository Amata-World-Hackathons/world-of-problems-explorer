(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[802],{3141:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/projects/[projectId]/anchors/new",function(){return n(6130)}])},6130:function(e,t,n){"use strict";n.r(t);var a=n(4051),r=n.n(a),s=n(5893),o=n(6158),c=n.n(o),l=n(7536),i=n(1163),u=n(4297),m=n(7640),h=n(7294),p=n(8909),d=n(4988),f=n(4184),x=n.n(f),g=n(9612);function y(e,t,n,a,r,s,o){try{var c=e[s](o),l=c.value}catch(i){return void n(i)}c.done?t(l):Promise.resolve(l).then(a,r)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){b(e,t,n[t])}))}return e}c().accessToken="pk.eyJ1IjoiYW1hdGFoYWNrc25qYW1zIiwiYSI6ImNsMHAzNWdkdDFnOHQzZHBlMmx0Mml6a3IifQ.aKW4wLfYZuEPgoisxwRjdw";var w=function(e){var t=e.project,n=(0,g.NB)(),a=(n.width,n.height,n.ref),u=(0,i.useRouter)(),f=(0,l.cI)({defaultValues:{name:"",imageUrl:t.imageUrls[0],contents:"",impactRange:"neighbourhood",callToActionUrl:t.callToActionUrl}}),b=f.register,w=f.handleSubmit,v=(0,h.useState)(t?t.tags.map((function(e){return{id:e,text:e}})):[]),N=(v[0],v[1],(0,h.useState)({lat:0,lng:0})),k=N[0],I=N[1],U=((0,d.aC)().user,(0,m.lc)().createProjectAnchor),P=(0,h.useState)([]),R=P[0],L=(P[1],(0,h.useState)(t.imageUrls)),O=L[0],T=L[1],_=(0,h.useRef)(),C=(0,h.useRef)(null);(0,h.useEffect)((function(){R.length<1||T(R.map((function(e){return URL.createObjectURL(e)})))}),[R]),(0,h.useEffect)((function(){if(a.current&&!C.current){var e=new o.Map({container:a.current,style:"mapbox://styles/amatahacksnjams/cl0p3l629000d15s8e4ekv0uj",center:[0,0],zoom:2,minZoom:1});C.current=e;var t=null;e.on("click",(function(n){I({lat:n.lngLat.lat,lng:n.lngLat.lng}),t&&t.remove(),t=(new(c().Marker)).setLngLat([n.lngLat.lng,n.lngLat.lat]).addTo(e)}))}}),[a.current]);var E=t.tags[0],S=(0,p.JC)(E),A=(0,p.Ep)(E);return(0,s.jsxs)("section",{className:"w-full max-w-xl m-auto mt-24",children:[(0,s.jsx)("h1",{className:x()("text-3xl mb-4",S),children:"Impact marker"}),(0,s.jsx)("div",{className:x()("my-4 h-1",A)}),(0,s.jsxs)("form",{onKeyDown:function(e){return e.stopPropagation()},onSubmit:w(function(){var e,n=(e=r().mark((function e(n){var a,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={name:n.name||"Untitled",projectId:t.id,latitude:k.lat,longitude:k.lng,impactRange:n.impactRange,imageUrl:O[0],contents:n.contents,callToActionUrl:n.callToActionUrl},e.next=3,U(a);case 3:s=e.sent,u.push({pathname:"/",query:{lat:s.latitude,lng:s.longitude,zoom:13}});case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(a,r){var s=e.apply(t,n);function o(e){y(s,a,r,o,c,"next",e)}function c(e){y(s,a,r,o,c,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}()),children:[(0,s.jsx)("label",{htmlFor:"name",className:"uppercase font-mono text-xs text-slate-200 mt-4",children:"Impact marker name:"}),(0,s.jsx)("input",j({id:"name",type:"text"},b("name"),{className:"w-full mb-4 py-2 px-1 text-slate-900",placeholder:"e.g. Poverty struck neighbourhood will benefit from programme"})),(0,s.jsx)("div",{className:x()("my-4 h-1",A)}),(0,s.jsx)("div",{ref:a,className:"w-full h-72"}),(0,s.jsx)("label",{htmlFor:"range",className:"uppercase font-mono text-xs text-slate-200 mt-4",children:"Impact range:"}),(0,s.jsxs)("select",j({id:"range"},b("impactRange"),{className:"w-full max-w-sm block p-2 text-slate-900",children:[(0,s.jsx)("option",{value:"neighbourhood",children:"Neighbourhood"}),(0,s.jsx)("option",{value:"state",children:"State"}),(0,s.jsx)("option",{value:"country",children:"Country"}),(0,s.jsx)("option",{value:"continent",children:"Continent"}),(0,s.jsx)("option",{value:"location",children:"Location"})]})),(0,s.jsx)("div",{className:x()("my-4 h-1",A)}),O.map((function(e){return(0,s.jsx)("img",{src:e,alt:"something",className:"m-auto"},e)})),(0,s.jsx)("label",{htmlFor:"imageUrl",className:"uppercase font-mono text-xs text-slate-200 mt-4",children:"Image URLs:"}),(0,s.jsx)("input",j({id:"name",type:"text"},b("imageUrl"),{className:"w-full mb-4 py-2 px-1 text-slate-900",placeholder:"Link to a self-hosted image",onChange:function(e){_.current&&clearTimeout(_.current),_.current=setTimeout((function(){T([e.target.value])}),500)}})),(0,s.jsx)("div",{className:x()("my-4 h-1",A)}),(0,s.jsx)("label",{htmlFor:"contents",className:"uppercase font-mono text-xs text-slate-200 mt-4",children:"Page contents:"}),(0,s.jsx)("textarea",j({id:"contents"},b("contents"),{rows:10,className:"w-full p-2 text-slate-900",placeholder:"The contents of the page"})),(0,s.jsx)("small",{className:"text-slate-400 text-xs block",children:"Markdown format is supported"}),(0,s.jsx)("label",{htmlFor:"contents",className:"uppercase font-mono text-xs text-slate-200 mt-4",children:"Call to action (optional):"}),(0,s.jsx)("input",j({type:"text"},b("callToActionUrl"),{className:"w-full mb-2 py-2 px-1 text-slate-900",placeholder:"https://mycharity.com/fundraiseme"})),(0,s.jsx)("small",{className:"text-slate-400 text-xs block mb-4",children:"A link to a call to action for those who would like to know more"}),(0,s.jsxs)("div",{className:"flex flex-row justify-end",children:[(0,s.jsx)("button",{type:"button",className:"py-2 px-4",onClick:function(){return t?u.push({pathname:"/projects/[projectId]",query:{projectId:t.id}}):u.push("/")},children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"py-2 px-4 rounded-lg border-2 border-cyan-600 shadow-sm shadow-cyan-600",children:"Submit"})]}),(0,s.jsx)("hr",{className:"my-4"})]})]})};t.default=function(){var e=(0,i.useRouter)().query.projectId,t=(0,m.n5)(e).data;return(0,s.jsx)("div",{className:"bg-slate-800 text-slate-300 overflow-y-auto h-screen",children:t?(0,s.jsx)(w,{project:t.project}):(0,s.jsx)(u.Z,{className:"block fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"})})}},8909:function(e,t,n){"use strict";n.d(t,{iF:function(){return a},Ep:function(){return s},JC:function(){return o},pQ:function(){return c}});var a=["technology","artificial intelligence","augmented reality","health","medicine","well-being","spirituality","exercise","environment","pollution","water-pollution","air-pollution","deforestation","endangered-species","society","culture","history","poverty","obesity","humanitarian","charity","disaster-relief","humanitarian-aid"];function r(e){switch(e){case"technology":case"artificial intelligence":case"augmented reality":return"technology";case"health":case"medicine":case"well-being":case"spirituality":case"exercise":return"health";case"environment":case"pollution":case"water-pollution":case"air-pollution":case"deforestation":case"endangered-species":return"environment";case"society":case"culture":case"history":case"poverty":case"obesity":return"society";case"charity":case"humanitarian":case"disaster-relief":case"humanitarian-aid":return"humanitarian"}}function s(e){switch(r(e)){case"environment":return"bg-green-500";case"health":return"bg-pink-500";case"humanitarian":return"bg-red-500";case"society":return"bg-teal-500";case"technology":return"bg-sky-500";default:return"bg-slate-500"}}function o(e){switch(r(e)){case"environment":return"text-green-500";case"health":return"text-pink-500";case"humanitarian":return"text-red-500";case"society":return"text-teal-500";case"technology":return"text-sky-500";default:return"text-slate-500"}}function c(e){var t=2.1;switch(e.impactRange){case"location":t=15;break;case"neighbourhood":t=12;break;case"state":t=9.8;break;case"country":t=7;break;case"continent":t=4}return{lat:e.latitude,lng:e.longitude,zoom:t}}}},function(e){e.O(0,[634,536,612,774,888,179],(function(){return t=3141,e(e.s=t);var t}));var t=e.O();_N_E=t}]);